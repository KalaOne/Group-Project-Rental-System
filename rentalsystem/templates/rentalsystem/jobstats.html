{% extends 'rentalsystem/base.html' %}

{% block title %}My Jobs{% endblock %}

{% block content %}
    <h2>Job Statistics For {{ searched_region }} {{ day_sort }}</h2>


    <form action='/jobstats/' method='POST'>
        {% csrf_token %}
        {#        <input type="text" id="region" name="region">#}
        <select name="region">
            <option value="All" selected="selected">All Regions</option>
            <option value="Greater London">Greater London</option>
            <option value="West Midlands">West Midlands</option>
            <option value="Greater Manchester">Greater Manchester</option>
            <option value="West Yorkshire">West Yorkshire</option>
            <option value="Hampshire">Hampshire</option>
            <option value="Kent">Kent</option>
            <option value="Essex">Essex</option>
            <option value="Lancashire">Lancashire</option>
            <option value="Merseyside">Merseyside</option>
            <option value="South Yorkshire">South Yorkshire</option>
            <option value="Devon">Devon</option>
            <option value="Surrey">Surrey</option>
            <option value="Hertfordshire">Hertfordshire</option>
            <option value="North Yorkshire">North Yorkshire</option>
            <option value="Nottinghamshire">Nottinghamshire</option>
            <option value="Tyne and Wear">Tyne and Wear</option>
            <option value="Staffordshire">Staffordshire</option>
            <option value="Lincolnshire">Lincolnshire</option>
            <option value="Cheshire">Cheshire</option>
            <option value="Derbyshire">Derbyshire</option>
            <option value="Leicestershire">Leicestershire</option>
            <option value="Somerset">Somerset</option>
            <option value="Gloucestershire">Gloucestershire</option>
            <option value="Berkshire">Berkshire</option>
            <option value="Norfolk">Norfolk</option>
            <option value="County Durham">County Durham</option>
            <option value="West Sussex">West Sussex</option>
            <option value="Cambridgeshire">Cambridgeshire</option>
            <option value="East Sussex">East Sussex</option>
            <option value="Buckinghamshire">Buckinghamshire</option>
            <option value="Dorset">Dorset</option>
            <option value="Suffolk">Suffolk</option>
            <option value="Northamptonshire">Northamptonshire</option>
            <option value="Wiltshire">Wiltshire</option>
            <option value="Oxfordshire">Oxfordshire</option>
            <option value="Bedfordshire">Bedfordshire</option>
            <option value="East Riding of Yorkshire">East Riding of Yorkshire</option>
            <option value="Worcestershire">Worcestershire</option>
            <option value="Warwickshire">Warwickshire</option>
            <option value="Cornwall">Cornwall</option>
            <option value="Cumbria">Cumbria</option>
            <option value="Shropshire">Shropshire</option>
            <option value="Bristol">Bristol</option>
            <option value="Northumberland">Northumberland</option>
            <option value="Herefordshire">Herefordshire</option>
            <option value="Isle of Wight">Isle of Wight</option>
            <option value="Rutland">Rutland</option>
            <option value="City of London">City of London</option>
        </select>
        <select name="days">
            <option value="1 day">1 day</option>
            <option value="1 week">1 week</option>
            <option value="2 weeks">2 weeks</option>
            <option value="1 month">1 month</option>
            <option value="3 months">3 months</option>
            <option value="All time" selected="selected">All time</option>
        </select>
        <button class="btn btn-primary btn-sm">Filter by region</button>
    </form>
    <p>

    <div class="container">
        <div class="row">
            <div class="col-sm">
                {#  DELIVERED/COPLETED JOBS  #}
                <div class="text-white bg-success mb-3" style="overflow-y: scroll; height:400px;">
                    <div class="card-header">
                        <h10 class="card-title">{{ total_jobs_completed_count }} Jobs completed</h10>
                        <i style="margin-left: 15px" class="text-dark small">Ordered by delivered date</i>
                    </div>
                    <div class="card-body">
                        {% if jobs.count > 0 %}
                            <table class="table bg-success" style="border-top: none">
                                <tr style="border:none">
                                    <th class="text-center"> JOB ID</th>
                                    <th class="text-center"> PRODUCT</th>
                                    <th class="text-center"> CUSTOMER</th>
                                    <th class="text-center"> DELIVERED</th>
                                    <th class="text-center"> STAFF</th>
                                </tr>
                                {% for job in jobs %}
                                    <tr>
                                        <td class="text-white text-center">  {{ job.id }} </td>
                                        <td class="text-white text-center">  {{ job.transaction_id.item_id.name }} </td>
                                        <td class="text-white text-center">  {{ job.transaction_id.renter_id }} </td>
                                        <td class="text-white text-center">  {{ job.delivered_datetime }} </td>
                                        <td class="text-white text-center">  {{ job.job_list_id.staff_id }} </td>
                                    </tr>
                                {% endfor %}
                            </table>
                        {% endif %}
                    </div>
                </div>



                {#  UNALLOCATED JOBS  #}
                <div class="text-white bg-danger mb-3" style="overflow-y: scroll; height:400px;">
                    <div class="card-header">
                        <h10 class="card-title">{{ nun_unalloc_jobs }} Unallocated jobs</h10>
                        <i style="margin-left: 15px" class="text-dark small">Ordered by expected delivery date</i>
                    </div>
                    <div class="card-body">
                        {% if jobs.count > 0 %}
                            <table class="table bg-danger" style="border-top: none">
                                <tr style="border:none">
                                    <th class="text-center"> JOB ID</th>
                                    <th class="text-center"> PRODUCT</th>
                                    <th class="text-center"> CUSTOMER</th>
                                    <th class="text-center"> DUE DELIVERY</th>
                                </tr>
                                {% for job in unalloc_jobs %}
                                    <tr>
                                        <td class="text-white text-center">  {{ job.id }} </td>
                                        <td class="text-white text-center">  {{ job.transaction_id.item_id.name }} </td>
                                        <td class="text-white text-center">  {{ job.transaction_id.renter_id }} </td>
                                        <td class="text-white text-center">  {{ job.due_delivery_datetime }} </td>
                                    </tr>
                                {% endfor %}
                            </table>
                        {% endif %}
                    </div>
                </div>

                {#  UNDELIVERED JOBS  #}
                <div class="text-white bg-warning mb-3" style="overflow-y: scroll; height:400px;">
                    <div class="card-header">
                        <h10 class="card-title">{{ nun_undelivered_jobs }} Undelivered jobs</h10>
                        <i style="margin-left: 15px" class="text-dark small">Ordered by expected delivery date</i>
                    </div>
                    <div class="card-body">
                        {% if jobs.count > 0 %}
                            <table class="table bg-warning" style="border-top: none">
                                <tr style="border:none">
                                    <th class="text-center"> JOB ID</th>
                                    <th class="text-center"> PRODUCT</th>
                                    <th class="text-center"> CUSTOMER</th>
                                    <th class="text-center"> DUE DELIVERY</th>
                                    <th class="text-center"> STAFF</th>
                                </tr>
                                {% for job in undelivered_jobs %}
                                    <tr>
                                        <td class="text-white text-center">  {{ job.id }} </td>
                                        <td class="text-white text-center">  {{ job.transaction_id.item_id.name }} </td>
                                        <td class="text-white text-center">  {{ job.transaction_id.renter_id }} </td>
                                        <td class="text-white text-center">  {{ job.due_delivery_datetime }} </td>
                                        <td class="text-white text-center">  {{ job.job_list_id.staff_id }} </td>
                                    </tr>
                                {% endfor %}
                            </table>
                        {% endif %}
                    </div>
                </div>

            </div>
        </div>
    </div>

{% endblock %}